# Cross-Validated Causal Inference
##  Example use
Install missing packages if needed. In the terminal, run 
```
python example_use.py
```
Results will be printed to the terminal.

## No-covariate setting

### Code 

``mean_eps.py``: Experiments varying bias.

``mean_n_obs.py``: Experiments varying the number of observational data.

``mean_n_exp.py``: Experiments varying the number of experimental data.

### Usage

Run 
```
python mean_eps.py
```
or 
```
python mean_n_obs.py
```
or 
```
python mean_n_exp.py
```
Results are saved as JSON files (for data) and PDF files (for figures). Detailed usage see python scripts. The current scripts may take a few minutes each. 

## Linear setting

### Code 

``linear_eps.py``: Experiments varying bias.

``linear_n_obs.py``: Experiments varying the number of observational data.

### Usage
Choice 1: Directly run 
```
python linear_eps.py
``` 
or 
```
python linear_n_obs.py
``` 

Choise 2: Use a bash script and specify ``--cpus-per-task`` for parallel computing.

Results are saved as JSON files (for data) and PDF files (for figures). Detailed usage see python scripts.


## Experiments on the LaLonde dataset
### Data
Download the ``.txt`` files of **NSW Data Files (Dehejia-Wahha Sample)** and **PSID and CPS Data Files** from [this link](http://users.nber.org/~rdehejia/nswdata2.html) and put them into a ``\data`` folder.

### Code

``lalonde_baseline.Rmd``: Estimation and bootstrap for linear model baselines for full configuration. 

``read_lalonde_data.R``: Script to read data, sourced in ``lalonde_baseline.Rmd``.

``lalonde_cv.py``: Run our method on the LaLonde dataset (linear setting). Full configurations.

``lalonde_cv_bootstrap.py``: Bootstrap our method on the LaLonde dataset (linear setting). Full configurations.

``read_lalonde_data.py``: Script to read data and generate ``lalonde.csv``. Python alternative of ``read_lalonde_data.R``. 

``lalonde_intro_mean.py``: Run our method on the LaLonde dataset (no-covariate setting). Single configuration. This is used for the intro figure.

``lalonde_intro_linear.py``: Run our method on the LaLonde dataset (linear setting). Single configuration. This is used for the intro figure.

``lalonde_synthetic_linear.py``: Experiments on synthetic data based on LaLonde dataset (linear setting). Single configuration.

### Usage

The R Markdown script can be run in [RStudio](https://rmarkdown.rstudio.com/lesson-2.html).

The python scripts use a data file ``lalonde.csv``, which is generated by ``lalonde_baseline.Rmd``. For users who are not familiar with R, one can use ``read_lalonde_data.py`` to generate the data file instead. 

To run the python scripts,

Choice 1: Directly run 
```
python lalonde_cv.py
``` 
or 
```
python lalonde_cv_bootstrap.py
```
or 
```
python lalonde_intro_mean.py
```
or 
```
python lalonde_intro_linear.py
```
or 
```
python lalonde_synthetic_linear.py
``` 
Results are saved as JSON files (for data) and TXT files (for tables or texts).

Choise 2: For full configurations, use a bash script and specify ``--cpus-per-task`` for parallel computing. For single configuration, use arguments specify in the script.



